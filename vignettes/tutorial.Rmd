---
title: "Project 3: StatsTools Tutorial"
author: "Marc R Radke"
date: "18 March 2021"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Project 3: StatsTools Tutorial}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

<!--- Begin styling code. --->

```{=html}
<style type="text/css">
/* Whole document: */
body{
  font-family: Cambria, Georgia, Palatino, serif;
  font-size: 14pt;
}
h1.title {
  font-size: 38px;
  text-align: center;
}
h4.author {
  font-size: 18px;
  text-align: center;
}
h4.date {
  font-size: 18px;
  text-align: center;
}
</style>
```
<!--- End styling code. --->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, echo = FALSE}
library(StatsTools)
```

## Introduction

StatsTools is a package of statistics functions written as part of the STAT302 class at the University of Washington. It includes a t-test, a linear model, an implementation and cross-validation of the k-nearest neighbor algorithm, and cross-validation of a random forest algorithm applied to the `palmerpenguins` data.

You can install from Github and load StatsTools with:

```{r, eval = FALSE}
# install.packages("devtools")
devtools::install_github("marcradke/StatsTools")
library(StatsTools)
```

## `my_t.test`

We will use the `lifeExp` data from `my_gapminder` to demonstrate the t-test function.

First, we will test the hypothesis 
  \begin{align}
  H_0: \mu &= 60,\\
  H_a: \mu &\neq 60.
  \end{align}

```{r}
# Load my_gapminder data
data(my_gapminder)
# Call function with default alternative setting
my_t.test(my_gapminder$lifeExp, mu = 60)
```

Using a p-value cut-off of $\alpha = 0.05$, we fail to reject the null hypothesis that the true mean life expectancy is 60 and find no evidence to support the alternative hypothesis that the true mean life expectancy is not equal to 60.

Next, we will test the hypothesis 
  \begin{align}
  H_0: \mu &= 60,\\
  H_a: \mu &< 60.
  \end{align}

```{r}
my_t.test(my_gapminder$lifeExp, alternative = "less", mu = 60)
```

Again using $\alpha = 0.05$, here we are able to reject the null hypothesis and find that the data support our alternative hypothesis: that the true life expectancy is less than 60.

Finally, we will test the hypothesis 
  \begin{align}
  H_0: \mu &= 60,\\
  H_a: \mu &> 60.
  \end{align}

```{r}
my_t.test(my_gapminder$lifeExp, alternative = "greater", mu = 60)
```

With $\alpha = 0.05$, we fail to reject our null hypothesis and find no evidence to support the alternative hypothesis that the true mean life expectancy is greater than 60.

## `my_lm`

To demonstrate the linear model function, we will again use data from `my_gapminder` and fit a linear model of the form `lifeExp ~ gdpPercap + continent`.

```{r, warning = FALSE}
# Fit linear model
gap_lm <- my_lm(lifeExp ~ gdpPercap + continent, data = my_gapminder)
gap_lm
```

An estimate of 0.00045 for the coefficient of `gdpPercap` means that, all other covariate being equal, a change of one unit in `gdpPercap` would change `lifeExp` by 0.00045. The table also gives us output of a hypothesis test with null hypothesis that the coefficient of `gdpPercap` is equal to zero and the alternativee hypothesis that it is not equal to zero. Using a p-value cutoff of $\alpha = 0.05$, we reject the null hypothesis and find evidence that the coefficient is not zero.

We can plot the actual and fitted values of `gdpPercap` to get a sense of our model fit:

```{r, fig.width = 7, fig.height = 5, fig.align = "center"}
library(ggplot2)
# Get actual values
actual <- my_gapminder$lifeExp
# Extract model matrix X from linear model
X <- stats::model.matrix(lifeExp ~ gdpPercap + continent, data = my_gapminder)
# Create vector of fitted values (Y-hat) by matrix-multiplying X by estimates
# of the coefficients (beta)
fitted <- X %*% as.matrix(gap_lm$Estimate)
# Combine into dataframe
avsf <- data.frame("fitted" = fitted,
                   "actual" = actual)
# Plot Actual vs. Fitted
avsfPlot <- ggplot(data = avsf, aes(y = actual, x = fitted)) +
  geom_point(size = .75) +
  geom_abline(slope = 1, intercept = 0, lty = 2) + 
  labs(title = "Actual vs. Fitted",
       y = "Actual",
       x = "Fitted") +
  ylim(20, 85) +
  xlim(20,110) +
  theme_gray(base_size = 14) +
  theme(plot.title = element_text(hjust = 0.5), 
        plot.margin = margin(0.5, 1, 0.5, 0.5, "cm"))
avsfPlot

```

For a well-fit model, we would expect points around the line `y = x`. Our model appears to be a decent fit for values above ~ 70, but very poor otherwise.

## `my_knn_cv`




## `my_rf_cv`
